-- Set up SQLite3 database for fail2ban

-- Create table fail2ban
CREATE TABLE fail2ban (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  name TEXT NOT NULL,
  protocol TEXT NOT NULL,
  ports TEXT NOT NULL,
  ip TEXT NOT NULL,
  longitude TEXT,
  latitude TEXT,
  code TEXT NOT NULL,
  code3 TEXT NOT NULL,
  city TEXT DEFAULT '',
  country TEXT,
  timestamp DATETIME DEFAULT NULL,
  ban INTEGER NOT NULL DEFAULT 1
);

-- Ensure database settings
PRAGMA foreign_keys = ON;
PRAGMA encoding = "UTF-8";
PRAGMA journal_mode = WAL;

-- Add index to the fail2ban table
CREATE INDEX idx_fail2ban_ip ON fail2ban (ip);
CREATE INDEX idx_fail2ban_country ON fail2ban (country);

